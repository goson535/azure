!function(n){lwptocMain.postId&&(tinymce.PluginManager.add("lwptoc",function(t){t.addButton("lwptocButton",{icon:"lwptocButton",tooltip:lwptocMain.tableOfContents,onclick:function(){wp.mce.lwptoc.popupWindow(t,!1,{})}})}),wp.mce.lwptoc={viewCounter:0,cache:{},getContent:function(){var t=this,c="lwptocShortcode"+ ++wp.mce.lwptoc.viewCounter,e=JSON.stringify(this.shortcode.attrs.named);return void 0===wp.mce.lwptoc[e]?(n.ajax({url:lwptocMain.ajaxUrl,data:{_ajax_nonce:lwptocMain.nonce,action:"lwptoc_shortcode_view",attrs:this.shortcode.attrs.named},success:function(o){wp.mce.lwptoc[e]=o,t.getEditors(function(t){n(t.getBody()).find("#"+c).replaceWith(o)})}}),'<div class="lwptocShortcode lwptocShortcode-loading" id="'+c+'"><div class="lwptocShortcode_title">'+lwptocMain.tableOfContents+"</div></div>"):wp.mce.lwptoc[e]},edit:function(t,o){wp.mce.lwptoc.popupWindow(tinyMCE.activeEditor,o,wp.shortcode.next(lwptocMain.shortcodeTag,t).shortcode.attrs.named)},popupWindow:function(c,e,t){n(document).one("lwptocShortcodeGenerated",function(t,o){!1===e?c.insertContent(o.shortcode):e(o.shortcode)}),n.lwptocCustomize.show({action:"lwptoc_shortcode_customize",attrs:t,postId:lwptocMain.postId},function(){n(document).off("lwptocShortcodeGenerated")})}},wp.mce.views.register(lwptocMain.shortcodeTag,wp.mce.lwptoc))}(jQuery);